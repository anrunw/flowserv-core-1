workflow:
    version: 0.3.0
    inputs:
      files:
        - code/analyze.py
        - code/helloworld.py
        - $[[names]]
      parameters:
        inputfile: $[[names]]
        outputfile: results/greetings.txt
        sleeptime: $[[sleeptime]]
        greeting: $[[greeting]]
    workflow:
      type: serial
      specification:
        steps:
          - environment: 'python:3.7'
            commands:
              - python code/helloworld.py
                  --inputfile "${inputfile}"
                  --outputfile "${outputfile}"
                  --sleeptime ${sleeptime}
                  --greeting ${greeting}
              - python code/analyze.py
                  --inputfile "${outputfile}"
                  --outputfile results/analytics.json
    outputs:
      files:
       - results/greetings.txt
       - results/analytics.json
parameters:
    - id: names
      name: 'Input file'
      dtype: file
      target: data/names.txt
    - id: sleeptime
      name: 'Sleep time (s)'
      dtype: int
      defaultValue: 10
    - id: greeting
      name: 'Greeting'
      dtype: string
      defaultValue: 'Hello'
modules:
    - id: 'main'
      name: 'Main Step'
      index: 0
outputs:
    - source: 'results/greetings.txt'
      key: 'greetings'
      title: 'Saying Hello to ...'
      caption: 'Greetings for all persons.'
      format:
          type: 'plaintext'
    - source: 'results/analytics.json'
      title: 'Score'
      format:
          type: 'json'
results:
    file: 'results/analytics.json'
    schema:
        - id: avg_count
          name: 'Avg. Characters per Line'
          dtype: float
        - id: max_len
          name: 'Max. Output Line Length'
          dtype: float
        - id: max_line
          name: 'Longest Output Line'
          dtype: string
          required: False
